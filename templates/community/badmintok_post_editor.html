{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if is_update %}글 수정{% else %}글쓰기{% endif %} - 배드민톡</title>

    <!-- Editor.js -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet">

    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background: #f5f7fa;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }

        /* 워드프레스 스타일 레이아웃 */
        .wp-editor-wrapper {
            display: flex;
            min-height: 100vh;
            padding-top: 60px;
        }

        .wp-editor-main {
            flex: 1;
            max-width: 100%;
            background: #fff;
            transition: all 0.3s ease;
        }

        .wp-editor-sidebar {
            width: 320px;
            background: #fff;
            border-left: 1px solid #e2e8f0;
            padding: 24px;
            overflow-y: auto;
            position: sticky;
            top: 60px;
            height: calc(100vh - 60px);
            transition: all 0.3s ease;
        }

        /* 전체 화면 모드 */
        .fullscreen-mode .wp-editor-sidebar {
            transform: translateX(100%);
            opacity: 0;
            pointer-events: none;
        }

        .fullscreen-mode .wp-editor-main {
            max-width: 100%;
        }

        /* 상단 툴바 */
        .wp-top-toolbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: #fff;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
            z-index: 1000;
        }

        .wp-top-toolbar-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .wp-top-toolbar-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .wp-back-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #64748b;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            padding: 8px 12px;
            border-radius: 20px;
            transition: all 0.2s;
        }

        .wp-back-btn:hover {
            background: #f1f5f9;
            color: #334155;
        }

        .wp-fullscreen-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border: 1px solid #e2e8f0;
            border-radius: 20px;
            background: #fff;
            color: #64748b;
            cursor: pointer;
            transition: all 0.2s;
        }

        .wp-fullscreen-btn:hover {
            background: #f1f5f9;
            color: #334155;
            border-color: #cbd5e1;
        }

        .wp-save-status {
            font-size: 13px;
            color: #64748b;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .wp-save-status.saving {
            color: #f59e0b;
        }

        .wp-save-status.saved {
            color: #10b981;
        }

        /* 에디터 영역 */
        .wp-editor-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 48px 24px;
        }

        .fullscreen-mode .wp-editor-content {
            max-width: 900px;
        }

        /* 제목 입력 */
        .wp-title-input {
            width: 100%;
            border: none;
            outline: none;
            font-size: 40px;
            font-weight: 700;
            color: #1e293b;
            padding: 12px 0;
            margin-bottom: 24px;
            background: transparent;
            resize: none;
            overflow: hidden;
            line-height: 1.2;
        }

        .wp-title-input::placeholder {
            color: #cbd5e1;
        }

        /* Editor.js 커스터마이징 */
        .wp-editorjs-wrapper {
            border: none;
        }

        #editorjs-content {
            min-height: 500px;
            background: #fff;
            border: none;
            font-size: 16px;
            line-height: 1.8;
        }

        /* Editor.js 기본 스타일 */
        .codex-editor {
            border: none !important;
        }

        .codex-editor__redactor {
            padding-bottom: 100px !important;
        }

        .ce-block__content {
            max-width: 100%;
            margin: 0;
        }

        .ce-paragraph {
            font-size: 16px;
            line-height: 1.8;
            color: #334155;
            margin-bottom: 16px;
        }

        .ce-header {
            font-weight: 700;
            color: #1e293b;
            margin: 32px 0 16px;
        }

        .ce-header[contentEditable=true][data-placeholder]:empty::before {
            color: #cbd5e1;
        }

        /* 툴바 스타일 */
        .ce-toolbar__content {
            max-width: 100%;
        }

        .ce-toolbar__plus,
        .ce-toolbar__settings-btn {
            color: #64748b;
        }

        .ce-toolbar__plus:hover,
        .ce-toolbar__settings-btn:hover {
            background: #f1f5f9;
            color: #334155;
        }

        .ce-inline-toolbar {
            background: #fff;
            border: 1px solid #e2e8f0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .ce-inline-tool {
            color: #64748b;
        }

        .ce-inline-tool:hover {
            background: #f1f5f9;
            color: #334155;
        }

        .ce-conversion-toolbar {
            background: #fff;
            border: 1px solid #e2e8f0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .ce-popover {
            background: #fff;
            border: 1px solid #e2e8f0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .ce-popover__item:hover {
            background: #f1f5f9;
        }

        /* 사이드바 스타일 */
        .wp-sidebar-section {
            margin-bottom: 24px;
            padding-bottom: 24px;
            border-bottom: 1px solid #e2e8f0;
        }

        .wp-sidebar-section:last-child {
            border-bottom: none;
        }

        .wp-sidebar-title {
            font-size: 14px;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .wp-form-group {
            margin-bottom: 16px;
        }

        .wp-form-label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            color: #475569;
            margin-bottom: 8px;
        }

        .wp-form-select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 20px;
            font-size: 14px;
            color: #334155;
            background: #fff;
            cursor: pointer;
            transition: all 0.2s;
        }

        .wp-form-select:hover {
            border-color: #cbd5e1;
        }

        .wp-form-select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .wp-checkbox-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .wp-checkbox-wrapper:hover {
            background: #f8fafc;
        }

        .wp-checkbox-wrapper input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: #3b82f6;
        }

        .wp-checkbox-label {
            font-size: 14px;
            font-weight: 500;
            color: #334155;
            cursor: pointer;
        }

        /* 버튼 스타일 */
        .wp-btn {
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .wp-btn-primary {
            background: #3b82f6;
            color: #fff;
        }

        .wp-btn-primary:hover {
            background: #2563eb;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .wp-btn-primary:disabled {
            background: #94a3b8;
            cursor: not-allowed;
        }

        .wp-btn-secondary {
            background: #fff;
            color: #64748b;
            border: 1px solid #e2e8f0;
        }

        .wp-btn-secondary:hover {
            background: #f8fafc;
            border-color: #cbd5e1;
        }

        /* 드래그 앤 드롭 오버레이 */
        .wp-drag-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(59, 130, 246, 0.1);
            backdrop-filter: blur(4px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .wp-drag-overlay.active {
            display: flex;
        }

        .wp-drag-content {
            background: #fff;
            padding: 48px;
            border-radius: 16px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
            text-align: center;
        }

        .wp-drag-icon {
            font-size: 64px;
            color: #3b82f6;
            margin-bottom: 16px;
        }

        .wp-drag-text {
            font-size: 18px;
            font-weight: 600;
            color: #1e293b;
        }

        /* 반응형 */
        @media (max-width: 1024px) {
            .wp-editor-sidebar {
                position: fixed;
                right: -320px;
                top: 60px;
                box-shadow: -4px 0 24px rgba(0, 0, 0, 0.1);
                z-index: 999;
            }

            .wp-editor-sidebar.mobile-visible {
                right: 0;
            }

            .wp-editor-main {
                max-width: 100%;
            }

            .wp-title-input {
                font-size: 32px;
            }
        }

        @media (max-width: 768px) {
            .wp-editor-content {
                padding: 24px 16px;
            }

            .wp-title-input {
                font-size: 28px;
            }

            .ql-toolbar {
                top: 60px;
            }
        }

        /* 숨김 필드 */
        #hidden_content {
            display: none;
        }

        /* Material Icons 스타일 */
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        /* 로딩 스피너 */
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .spinning {
            animation: spin 1s linear infinite;
        }

        /* 메시지 알림 */
        .messages {
            position: fixed;
            top: 70px;
            right: 24px;
            z-index: 10000;
        }

        .alert {
            padding: 12px 20px;
            border-radius: 8px;
            margin-bottom: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            animation: slideIn 0.3s ease-out;
        }

        .alert-success {
            background: #10b981;
            color: white;
        }

        .alert-error {
            background: #ef4444;
            color: white;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* SEO 체크리스트 스타일 */
        .seo-check-item {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            padding: 6px 0;
            color: #64748b;
            line-height: 1.4;
        }

        .seo-check-item.passed {
            color: #10b981;
        }

        .seo-check-item.failed {
            color: #ef4444;
        }

        .seo-check-icon {
            font-weight: 700;
            font-size: 14px;
            flex-shrink: 0;
        }

        .seo-check-item.passed .seo-check-icon {
            color: #10b981;
        }

        .seo-check-item.failed .seo-check-icon {
            color: #ef4444;
        }

        /* 이미지 Alt 텍스트 모달 */
        .alt-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }

        .alt-modal.active {
            display: flex;
        }

        .alt-modal-content {
            background: white;
            border-radius: 12px;
            padding: 24px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .alt-modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid #e2e8f0;
        }

        .alt-modal-title {
            font-size: 18px;
            font-weight: 700;
            color: #1e293b;
        }

        .alt-modal-close {
            background: none;
            border: none;
            cursor: pointer;
            color: #64748b;
            padding: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .alt-modal-close:hover {
            background: #f1f5f9;
            color: #1e293b;
        }

        .alt-modal-image {
            width: 100%;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #e2e8f0;
        }

        .alt-modal-form-group {
            margin-bottom: 16px;
        }

        .alt-modal-label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            color: #475569;
            margin-bottom: 8px;
        }

        .alt-modal-label .required {
            color: #ef4444;
        }

        .alt-modal-input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #cbd5e1;
            border-radius: 20px;
            font-size: 14px;
            font-family: inherit;
            transition: all 0.2s;
        }

        .alt-modal-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .alt-modal-footer {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 24px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
        }

        /* 버튼 블롯 스타일 */
        .ql-button-container {
            margin: 16px 0;
            position: relative;
        }

        .ql-button-wrapper {
            display: inline-block;
            position: relative;
        }

        .ql-button-wrapper:hover .ql-button-edit,
        .ql-button-wrapper:hover .ql-button-delete {
            opacity: 1;
        }

        .ql-button {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0;
            width: 70%;
            max-width: 100%;
            margin: 16px auto; /* 중앙 정렬, 상하 여백 추가 */
            padding: 12px 24px;
            font-size: 22px;
            font-weight: 600;
            line-height: 1.5;
            text-align: center;
            text-decoration: none;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            outline: none;
            background: #31AA60; /* 브랜드 컬러 */
            color: white !important; /* 항상 흰색으로 고정 */
            position: relative;
        }

        /* 모바일 반응형 */
        @media (max-width: 768px) {
            .ql-button {
                font-size: 18px;
                padding: 10px 20px;
            }
        }

        /* 링크 스타일 무시 */
        .ql-button:link,
        .ql-button:visited,
        .ql-button:hover,
        .ql-button:active {
            color: white !important;
            text-decoration: none !important;
        }

        .ql-button:hover {
            background: #279254; /* 브랜드 컬러 hover (--brand-700) */
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(49, 170, 96, 0.3);
        }

        /* 버튼 텍스트 */
        .ql-button-text {
            display: inline-block;
            line-height: 1.5;
        }

        /* 버튼 화살표 아이콘 */
        .ql-button-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            height: 1em;
            width: 1em;
            margin-left: 6px;
            vertical-align: baseline;
        }

        .ql-button-icon svg {
            height: 1em;
            width: 1em;
            fill: currentColor;
            display: block;
        }

        /* 스타일 옵션들도 브랜드 컬러로 통일 */
        .ql-button-primary {
            background: #31AA60;
            color: white !important;
        }

        .ql-button-primary:hover {
            background: #279254;
            color: white !important;
        }

        .ql-button-secondary {
            background: #31AA60;
            color: white !important;
        }

        .ql-button-secondary:hover {
            background: #279254;
            color: white !important;
        }

        .ql-button-outline {
            background: transparent;
            color: #31AA60 !important;
            border: 2px solid #31AA60;
        }

        .ql-button-outline:hover {
            background: #31AA60;
            color: white !important;
        }

        .ql-button-outline .ql-button-icon {
            color: inherit;
        }

        .ql-button-ghost {
            background: transparent;
            color: #31AA60 !important;
            border: 2px solid #31AA60;
        }

        .ql-button-ghost:hover {
            background: #31AA60;
            color: white !important;
        }

        .ql-button-ghost .ql-button-icon {
            color: inherit;
        }

        .ql-button-edit,
        .ql-button-delete {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: none;
            background: #fff;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 10;
        }

        .ql-button-delete {
            right: -8px;
            background: #ef4444;
            color: white;
            font-size: 18px;
            line-height: 1;
        }

        .ql-button-edit {
            right: 20px;
            background: #3b82f6;
            color: white;
        }

        .ql-button-edit:hover {
            background: #2563eb;
        }

        .ql-button-delete:hover {
            background: #dc2626;
        }

        /* 버튼 설정 모달 */
        .button-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 10002;
            align-items: center;
            justify-content: center;
        }

        .button-modal.active {
            display: flex;
        }

        .button-modal-content {
            background: white;
            border-radius: 12px;
            padding: 24px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .button-modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid #e2e8f0;
        }

        .button-modal-title {
            font-size: 18px;
            font-weight: 700;
            color: #1e293b;
        }

        .button-modal-close {
            background: none;
            border: none;
            cursor: pointer;
            color: #64748b;
            padding: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .button-modal-close:hover {
            background: #f1f5f9;
            color: #1e293b;
        }

        .button-modal-form-group {
            margin-bottom: 16px;
        }

        .button-modal-label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            color: #475569;
            margin-bottom: 8px;
        }

        .button-modal-label .required {
            color: #ef4444;
        }

        .button-modal-input,
        .button-modal-select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #cbd5e1;
            border-radius: 20px;
            font-size: 14px;
            font-family: inherit;
            transition: all 0.2s;
        }

        .button-modal-input:focus,
        .button-modal-select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .button-modal-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .button-modal-checkbox input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: #3b82f6;
        }

        .button-modal-preview {
            margin-top: 16px;
            padding: 16px;
            background: #f8fafc;
            border-radius: 8px;
            text-align: center;
        }

        .button-modal-footer {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 24px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
        }

        /* 이미지 크기 조정 모달 */
        .resize-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 10001;
            align-items: center;
            justify-content: center;
        }

        .resize-modal.active {
            display: flex;
        }

        .resize-modal-content {
            background: white;
            border-radius: 12px;
            padding: 24px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .resize-modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid #e2e8f0;
        }

        .resize-modal-title {
            font-size: 18px;
            font-weight: 700;
            color: #1e293b;
        }

        .resize-modal-close {
            background: none;
            border: none;
            cursor: pointer;
            color: #64748b;
            padding: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .resize-modal-close:hover {
            background: #f1f5f9;
            color: #1e293b;
        }

        .resize-preview {
            margin-bottom: 20px;
            padding: 16px;
            background: #f8fafc;
            border-radius: 8px;
            text-align: center;
        }

        .resize-preview img {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
            border: 2px solid #e2e8f0;
        }

        .resize-input-group {
            display: flex;
            gap: 12px;
            align-items: flex-end;
            margin-bottom: 16px;
        }

        .resize-input-wrapper {
            flex: 1;
        }

        .resize-input-label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            color: #475569;
            margin-bottom: 8px;
        }

        .resize-input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #cbd5e1;
            border-radius: 20px;
            font-size: 14px;
            font-family: inherit;
            transition: all 0.2s;
        }

        .resize-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .resize-unit {
            font-size: 13px;
            color: #64748b;
            margin-top: 8px;
        }

        .resize-presets {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 16px;
        }

        .resize-preset-btn {
            padding: 10px;
            border: 1px solid #e2e8f0;
            border-radius: 20px;
            background: #fff;
            color: #475569;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .resize-preset-btn:hover {
            background: #f8fafc;
            border-color: #cbd5e1;
        }

        .resize-preset-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        /* 에디터 내 이미지 크기 조정 핸들 */
        .ql-editor img {
            cursor: pointer;
            transition: all 0.2s;
            max-width: 100%;
            height: auto;
        }

        .ql-editor img:hover {
            outline: 2px solid #3b82f6;
            outline-offset: 2px;
        }

        .ql-editor img.resizing {
            outline: 2px solid #3b82f6;
            outline-offset: 2px;
        }

        /* 이미지 크기 표시 배지 */
        .image-size-badge {
            position: absolute;
            top: -24px;
            left: 0;
            background: #1e293b;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .ql-editor figure {
            position: relative;
            display: inline-block;
        }

        .ql-editor figure:hover .image-size-badge {
            opacity: 1;
        }

        /* 에디터 내부 버튼 스타일 */
        .ql-editor .ql-button-container {
            margin: 24px 0;
            position: relative;
            display: flex;
            justify-content: center;
            width: 100%;
        }

        .ql-editor .ql-button-wrapper {
            display: inline-block;
            position: relative;
            width: 70%;
        }

        .ql-editor .ql-button {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0;
            width: 100%;
            margin: 0 auto;
            padding: 12px 24px;
            font-size: 22px;
            font-weight: 600;
            line-height: 1.5;
            text-align: center;
            text-decoration: none;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            outline: none;
            background: #31AA60;
            color: white !important;
            position: relative;
        }

        .ql-editor .ql-button:link,
        .ql-editor .ql-button:visited,
        .ql-editor .ql-button:hover,
        .ql-editor .ql-button:active {
            color: white !important;
            text-decoration: none !important;
        }

        .ql-editor .ql-button:hover {
            background: #279254;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(49, 170, 96, 0.3);
        }

        .ql-editor .ql-button-text {
            display: inline-block;
            line-height: 1.5;
        }

        .ql-editor .ql-button-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            height: 1em;
            width: 1em;
            margin-left: 6px;
            vertical-align: baseline;
        }

        .ql-editor .ql-button-icon svg {
            height: 1em;
            width: 1em;
            fill: currentColor;
            display: block;
        }

        /* 모바일 반응형 */
        @media (max-width: 768px) {
            .ql-editor .ql-button {
                font-size: 18px;
                padding: 10px 20px;
            }
        }
    </style>
</head>
<body>
    <!-- 메시지 알림 -->
    {% if messages %}
    <div class="messages">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <div class="wp-editor-wrapper" id="wpEditorWrapper">
        <!-- 상단 툴바 -->
        <div class="wp-top-toolbar">
            <div class="wp-top-toolbar-left">
                <a href="{% url 'admin:badmintok_badmintokpost_changelist' %}" class="wp-back-btn">
                    <span class="material-symbols-outlined" style="font-size: 20px;">arrow_back</span>
                    관리자 페이지로
                </a>
                <div class="wp-save-status" id="saveStatus">
                    <span class="material-symbols-outlined" style="font-size: 16px;">check_circle</span>
                    <span id="saveStatusText">저장됨</span>
                </div>
            </div>
            <div class="wp-top-toolbar-right">
                <button type="button" class="wp-fullscreen-btn" id="fullscreenBtn" title="전체 화면 모드">
                    <span class="material-symbols-outlined">fullscreen</span>
                </button>
                <button type="button" class="wp-btn wp-btn-secondary" id="previewBtn">
                    <span class="material-symbols-outlined" style="font-size: 18px;">visibility</span>
                    미리보기
                </button>
                <button type="button" class="wp-btn" id="saveDraftBtn" style="background: #64748b; color: white;">
                    <span class="material-symbols-outlined" style="font-size: 18px;">save</span>
                    임시저장
                </button>
                <button type="submit" form="postForm" class="wp-btn wp-btn-primary" id="publishBtn">
                    <span class="material-symbols-outlined" style="font-size: 18px;">send</span>
                    {% if is_update %}수정 완료{% else %}게시하기{% endif %}
                </button>
            </div>
        </div>

        <!-- 메인 에디터 영역 -->
        <div class="wp-editor-main">
            <div class="wp-editor-content">
                <form method="post" enctype="multipart/form-data" id="postForm">
                    {% csrf_token %}

                    <!-- 제목 입력 -->
                    <textarea
                        name="title"
                        id="wpTitleInput"
                        class="wp-title-input"
                        placeholder="제목을 입력하세요"
                        rows="1"
                        maxlength="200">{% if post %}{{ post.title }}{% endif %}</textarea>

                    <!-- Editor.js -->
                    <div class="wp-editorjs-wrapper">
                        <div id="editorjs-content"></div>
                        <textarea name="content" id="hidden_content" style="display: none;">{% if post %}{{ post.content }}{% endif %}</textarea>
                    </div>

                    <!-- 썸네일 파일 인풋 (폼 안으로 이동) -->
                    <input type="file" name="thumbnail" id="id_thumbnail" accept="image/*" style="display: none;">
                    <input type="text" name="thumbnail_alt" id="id_thumbnail_alt" value="{% if post %}{{ post.thumbnail_alt }}{% endif %}" style="display: none;">
                </form>
            </div>
        </div>

        <!-- 사이드바 설정 패널 -->
        <div class="wp-editor-sidebar" id="wpSidebar">
            <!-- 게시글 설정 -->
            <div class="wp-sidebar-section">
                <h3 class="wp-sidebar-title">게시글 설정</h3>

                <div class="wp-form-group">
                    <label class="wp-form-label">카테고리 (복수 선택 가능)</label>
                    <div style="max-height: 300px; overflow-y: auto; border: 1px solid #e2e8f0; border-radius: 6px; padding: 12px; background: #fff;">
                        {% for category in categories %}
                            {% if category.parent %}
                                {# 하위 카테고리 - 체크박스, 들여쓰기 #}
                                <label style="display: block; padding: 6px 8px 6px 32px; margin: 2px 0; cursor: pointer; border-radius: 4px; transition: background 0.2s; font-size: 14px; color: #334155;" onmouseover="this.style.background='#f8fafc'" onmouseout="this.style.background='transparent'">
                                    <input type="checkbox" name="categories" value="{{ category.id }}" {% if post and category in post.categories.all %}checked{% endif %} form="postForm" style="margin-right: 8px; cursor: pointer;">
                                    {{ category.name }}
                                </label>
                            {% elif category.has_children %}
                                {# children이 있는 상위 카테고리 - 구분선과 함께 체크박스 표시 #}
                                <div style="border-top: {% if not forloop.first %}1px solid #e2e8f0{% else %}none{% endif %}; margin-top: 8px; padding-top: 8px;">
                                    <label style="display: block; padding: 6px 8px; margin: 2px 0; cursor: pointer; border-radius: 4px; transition: background 0.2s; font-size: 14px; font-weight: 700; color: #1e293b;" onmouseover="this.style.background='#f8fafc'" onmouseout="this.style.background='transparent'">
                                        <input type="checkbox" name="categories" value="{{ category.id }}" {% if post and category in post.categories.all %}checked{% endif %} form="postForm" style="margin-right: 8px; cursor: pointer;">
                                        {{ category.name }}
                                    </label>
                                </div>
                            {% else %}
                                {# children이 없는 독립 카테고리 - 체크박스 #}
                                <label style="display: block; padding: 6px 8px; margin: 2px 0; cursor: pointer; border-radius: 4px; transition: background 0.2s; font-size: 14px; color: #334155;" onmouseover="this.style.background='#f8fafc'" onmouseout="this.style.background='transparent'">
                                    <input type="checkbox" name="categories" value="{{ category.id }}" {% if post and category in post.categories.all %}checked{% endif %} form="postForm" style="margin-right: 8px; cursor: pointer;">
                                    {{ category.name }}
                                </label>
                            {% endif %}
                        {% endfor %}
                    </div>
                    <p style="font-size: 12px; color: #64748b; margin-top: 6px;">
                        <span class="material-symbols-outlined" style="font-size: 14px; vertical-align: middle;">info</span>
                        여러 카테고리를 선택할 수 있습니다
                    </p>
                </div>
            </div>

            <!-- 썸네일 -->
            <div class="wp-sidebar-section">
                <h3 class="wp-sidebar-title">썸네일</h3>

                <div class="wp-form-group">
                    <div id="thumbnail-preview" style="margin-bottom: 12px; border-radius: 8px; overflow: hidden; border: 1px solid #e2e8f0; background: #f8fafc;">
                        {% if post and post.thumbnail %}
                        <img src="{{ post.thumbnail.url }}" alt="썸네일" style="width: 100%; height: auto; display: block;">
                        {% else %}
                        <div style="padding: 48px 24px; text-align: center; color: #94a3b8;">
                            <span class="material-symbols-outlined" style="font-size: 48px; display: block; margin-bottom: 8px;">image</span>
                            <span style="font-size: 13px;">썸네일 없음</span>
                        </div>
                        {% endif %}
                    </div>
                    <button type="button" class="wp-btn wp-btn-secondary" id="uploadThumbnailBtn" style="width: 100%; justify-content: center;">
                        <span class="material-symbols-outlined" style="font-size: 18px;">upload</span>
                        썸네일 업로드
                    </button>
                    {% if post and post.thumbnail %}
                    <button type="button" class="wp-btn" id="removeThumbnailBtn" style="width: 100%; margin-top: 8px; background: #ef4444; color: white; justify-content: center;">
                        <span class="material-symbols-outlined" style="font-size: 18px;">delete</span>
                        썸네일 제거
                    </button>
                    {% endif %}
                </div>

                <div class="wp-form-group" style="margin-top: 16px;">
                    <label for="id_thumbnail_alt_display" class="wp-form-label">
                        썸네일 대체 텍스트
                        <span style="color: #64748b; font-weight: 400; font-size: 12px;">(SEO 권장)</span>
                    </label>
                    <input type="text"
                           id="id_thumbnail_alt_display"
                           value="{% if post %}{{ post.thumbnail_alt }}{% endif %}"
                           placeholder="썸네일 이미지를 설명하는 텍스트..."
                           class="wp-form-select"
                           style="font-family: inherit;">
                    <p style="font-size: 12px; color: #64748b; margin-top: 6px;">
                        <span class="material-symbols-outlined" style="font-size: 14px; vertical-align: middle;">info</span>
                        검색 엔진과 접근성을 위한 이미지 설명
                    </p>
                </div>
            </div>

            <!-- 발행 설정 -->
            <div class="wp-sidebar-section">
                <h3 class="wp-sidebar-title">발행 설정</h3>

                <div class="wp-form-group">
                    <label for="id_published_at" class="wp-form-label">발행 일시</label>
                    <input type="datetime-local"
                           name="published_at"
                           id="id_published_at"
                           value="{% if post and post.published_at %}{{ post.published_at|date:'Y-m-d\TH:i' }}{% endif %}"
                           class="wp-form-select"
                           style="font-family: inherit;"
                           form="postForm">
                    <p style="font-size: 12px; color: #64748b; margin-top: 6px;">비어있으면 즉시 발행됩니다</p>
                </div>
            </div>

            <!-- SEO 설정 -->
            <div class="wp-sidebar-section">
                <h3 class="wp-sidebar-title">SEO 설정</h3>

                <!-- SEO 점수 -->
                <div class="wp-form-group" style="margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                        <span style="font-size: 13px; font-weight: 600; color: #475569;">SEO 점수</span>
                        <span id="seoScore" style="font-size: 20px; font-weight: 700; color: #64748b;">0</span>
                    </div>
                    <div style="width: 100%; height: 8px; background: #e2e8f0; border-radius: 4px; overflow: hidden;">
                        <div id="seoScoreBar" style="width: 0%; height: 100%; background: #64748b; transition: all 0.3s ease;"></div>
                    </div>
                    <p style="font-size: 11px; color: #94a3b8; margin-top: 6px; text-align: center;" id="seoScoreLabel">분석 대기 중</p>
                </div>

                <div class="wp-form-group">
                    <label for="id_focus_keyword" class="wp-form-label">포커스 키워드</label>
                    <input type="text"
                           name="focus_keyword"
                           id="id_focus_keyword"
                           value="{% if post %}{{ post.focus_keyword }}{% endif %}"
                           placeholder="예: 배드민턴 라켓"
                           class="wp-form-select"
                           style="font-family: inherit;"
                           form="postForm">
                    <p style="font-size: 12px; color: #64748b; margin-top: 6px;">
                        <span id="keywordDensity" style="font-weight: 600; color: #3b82f6;">0회</span> 사용됨
                        <span id="keywordDensityPercent" style="margin-left: 8px; color: #64748b;">(0%)</span>
                    </p>
                </div>

                <div class="wp-form-group">
                    <label for="id_meta_description" class="wp-form-label">메타 설명</label>
                    <textarea name="meta_description"
                              id="id_meta_description"
                              rows="3"
                              maxlength="160"
                              placeholder="검색 엔진에 표시될 설명을 입력하세요..."
                              class="wp-form-select"
                              style="font-family: inherit; resize: vertical;"
                              form="postForm">{% if post %}{{ post.meta_description }}{% endif %}</textarea>
                    <p style="font-size: 12px; color: #64748b; margin-top: 6px;">
                        <span id="metaDescLength">0</span> / 160자
                    </p>
                </div>

                <div class="wp-form-group">
                    <label for="id_slug" class="wp-form-label">슬러그 (URL)</label>
                    <input type="text"
                           name="slug"
                           id="id_slug"
                           value="{% if post %}{{ post.slug }}{% endif %}"
                           placeholder="제목에서 자동 생성"
                           maxlength="45"
                           class="wp-form-select"
                           style="font-family: 'Courier New', monospace; font-size: 13px;"
                           form="postForm">
                    <p style="font-size: 12px; color: #64748b; margin-top: 6px;">
                        <span class="material-symbols-outlined" style="font-size: 14px; vertical-align: middle;">info</span>
                        한글 사용 가능 (최대 45자)
                    </p>
                </div>

                <!-- SEO 체크리스트 -->
                <div style="margin-top: 20px;">
                    <button type="button" id="seoChecklistToggle" style="width: 100%; padding: 12px; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 6px; display: flex; align-items: center; justify-content: space-between; cursor: pointer; font-size: 14px; font-weight: 600; color: #475569;">
                        <span>SEO 체크리스트 (<span id="seoCheckCount">0</span>/28)</span>
                        <span class="material-symbols-outlined" id="seoChecklistIcon">expand_more</span>
                    </button>
                    <div id="seoChecklist" style="display: none; margin-top: 12px; padding: 12px; background: #f8fafc; border-radius: 6px; font-size: 12px;">
                        <!-- 기본 SEO -->
                        <div style="margin-bottom: 16px;">
                            <div style="font-weight: 700; color: #1e293b; margin-bottom: 8px;">기본 SEO (0/11)</div>
                            <div class="seo-check-item" data-check="keyword-in-title">
                                <span class="seo-check-icon">○</span>
                                <span>제목에 포커스 키워드 포함</span>
                            </div>
                            <div class="seo-check-item" data-check="keyword-in-meta">
                                <span class="seo-check-icon">○</span>
                                <span>메타 설명에 포커스 키워드 포함</span>
                            </div>
                            <div class="seo-check-item" data-check="keyword-in-url">
                                <span class="seo-check-icon">○</span>
                                <span>URL에 포커스 키워드 포함</span>
                            </div>
                            <div class="seo-check-item" data-check="keyword-in-content">
                                <span class="seo-check-icon">○</span>
                                <span>본문에 포커스 키워드 사용 (1회 이상)</span>
                            </div>
                            <div class="seo-check-item" data-check="keyword-density">
                                <span class="seo-check-icon">○</span>
                                <span>키워드 밀도 적정 (0.5-2.5%)</span>
                            </div>
                            <div class="seo-check-item" data-check="content-length">
                                <span class="seo-check-icon">○</span>
                                <span>본문 길이 충분 (600자 이상)</span>
                            </div>
                            <div class="seo-check-item" data-check="title-length">
                                <span class="seo-check-icon">○</span>
                                <span>제목 길이 적정 (15-60자)</span>
                            </div>
                            <div class="seo-check-item" data-check="meta-length">
                                <span class="seo-check-icon">○</span>
                                <span>메타 설명 길이 적정 (120-160자)</span>
                            </div>
                            <div class="seo-check-item" data-check="url-length">
                                <span class="seo-check-icon">○</span>
                                <span>URL 길이 적정 (75자 이하)</span>
                            </div>
                            <div class="seo-check-item" data-check="keyword-beginning">
                                <span class="seo-check-icon">○</span>
                                <span>제목 앞부분에 키워드 배치</span>
                            </div>
                            <div class="seo-check-item" data-check="keyword-in-first-paragraph">
                                <span class="seo-check-icon">○</span>
                                <span>첫 문단에 포커스 키워드 포함</span>
                            </div>
                        </div>

                        <!-- 고급 SEO -->
                        <div style="margin-bottom: 16px;">
                            <div style="font-weight: 700; color: #1e293b; margin-bottom: 8px;">고급 SEO (0/8)</div>
                            <div class="seo-check-item" data-check="has-images">
                                <span class="seo-check-icon">○</span>
                                <span>이미지 포함 (1개 이상)</span>
                            </div>
                            <div class="seo-check-item" data-check="images-have-alt">
                                <span class="seo-check-icon">○</span>
                                <span>모든 이미지에 Alt 텍스트</span>
                            </div>
                            <div class="seo-check-item" data-check="has-internal-links">
                                <span class="seo-check-icon">○</span>
                                <span>내부 링크 포함 (2개 이상)</span>
                            </div>
                            <div class="seo-check-item" data-check="has-external-links">
                                <span class="seo-check-icon">○</span>
                                <span>외부 링크 포함 (1개 이상)</span>
                            </div>
                            <div class="seo-check-item" data-check="has-headings">
                                <span class="seo-check-icon">○</span>
                                <span>소제목 사용 (H2/H3)</span>
                            </div>
                            <div class="seo-check-item" data-check="keyword-in-headings">
                                <span class="seo-check-icon">○</span>
                                <span>소제목에 키워드 포함</span>
                            </div>
                            <div class="seo-check-item" data-check="has-thumbnail">
                                <span class="seo-check-icon">○</span>
                                <span>썸네일 이미지 설정</span>
                            </div>
                            <div class="seo-check-item" data-check="links-open-new-tab">
                                <span class="seo-check-icon">○</span>
                                <span>외부 링크 새 탭으로 열기</span>
                            </div>
                        </div>

                        <!-- 제목 분석 -->
                        <div style="margin-bottom: 16px;">
                            <div style="font-weight: 700; color: #1e293b; margin-bottom: 8px;">제목 분석 (0/5)</div>
                            <div class="seo-check-item" data-check="title-has-number">
                                <span class="seo-check-icon">○</span>
                                <span>제목에 숫자 포함</span>
                            </div>
                            <div class="seo-check-item" data-check="title-has-power-word">
                                <span class="seo-check-icon">○</span>
                                <span>제목에 파워 워드 사용</span>
                            </div>
                            <div class="seo-check-item" data-check="title-has-emotional-word">
                                <span class="seo-check-icon">○</span>
                                <span>제목에 감정 단어 사용</span>
                            </div>
                            <div class="seo-check-item" data-check="title-not-too-long">
                                <span class="seo-check-icon">○</span>
                                <span>제목 단어 수 적정 (6-13개)</span>
                            </div>
                            <div class="seo-check-item" data-check="title-sentiment-positive">
                                <span class="seo-check-icon">○</span>
                                <span>제목 긍정적 표현</span>
                            </div>
                        </div>

                        <!-- 가독성 -->
                        <div>
                            <div style="font-weight: 700; color: #1e293b; margin-bottom: 8px;">가독성 (0/4)</div>
                            <div class="seo-check-item" data-check="sentence-length">
                                <span class="seo-check-icon">○</span>
                                <span>문장 길이 적정 (25자 이하)</span>
                            </div>
                            <div class="seo-check-item" data-check="paragraph-length">
                                <span class="seo-check-icon">○</span>
                                <span>문단 길이 적정 (150자 이하)</span>
                            </div>
                            <div class="seo-check-item" data-check="has-lists">
                                <span class="seo-check-icon">○</span>
                                <span>목록 사용 (불릿 포인트/번호)</span>
                            </div>
                            <div class="seo-check-item" data-check="passive-voice-low">
                                <span class="seo-check-icon">○</span>
                                <span>수동태 사용 최소화</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 관리자 옵션 -->
            <div class="wp-sidebar-section">
                <h3 class="wp-sidebar-title">관리자 옵션</h3>

                <div class="wp-checkbox-wrapper">
                    <input type="checkbox"
                           name="is_pinned"
                           id="id_is_pinned"
                           {% if post and post.is_pinned %}checked{% endif %}
                           form="postForm">
                    <label for="id_is_pinned" class="wp-checkbox-label">상단 고정</label>
                </div>
            </div>

            <!-- 게시글 정보 -->
            <div class="wp-sidebar-section">
                <h3 class="wp-sidebar-title">문서 정보</h3>

                <div style="font-size: 13px; color: #64748b; line-height: 1.6;">
                    <p style="margin-bottom: 8px;">
                        <strong style="color: #475569;">작성자:</strong> {{ user.activity_name }}
                    </p>
                    {% if is_update %}
                    <p style="margin-bottom: 8px;">
                        <strong style="color: #475569;">작성일:</strong> {{ post.created_at|date:"Y.m.d H:i" }}
                    </p>
                    <p>
                        <strong style="color: #475569;">수정일:</strong> {{ post.updated_at|date:"Y.m.d H:i" }}
                    </p>
                    {% else %}
                    <p>
                        <strong style="color: #475569;">상태:</strong> 초안
                    </p>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- 드래그 앤 드롭 오버레이 -->
        <div class="wp-drag-overlay" id="dragOverlay">
            <div class="wp-drag-content">
                <div class="wp-drag-icon">
                    <span class="material-symbols-outlined" style="font-size: 64px;">upload_file</span>
                </div>
                <div class="wp-drag-text">이미지를 놓아주세요</div>
            </div>
        </div>

        <!-- 버튼 설정 모달 -->
        <div class="button-modal" id="buttonModal">
            <div class="button-modal-content">
                <div class="button-modal-header">
                    <h3 class="button-modal-title">버튼 설정</h3>
                    <button type="button" class="button-modal-close" id="buttonModalClose">
                        <span class="material-symbols-outlined" style="font-size: 24px;">close</span>
                    </button>
                </div>

                <div class="button-modal-form-group">
                    <label class="button-modal-label">
                        버튼 텍스트 <span class="required">*</span>
                    </label>
                    <input type="text" id="buttonModalText" class="button-modal-input" placeholder="예: 자세히 보기" required>
                </div>

                <div class="button-modal-form-group">
                    <label class="button-modal-label">
                        링크 URL <span class="required">*</span>
                    </label>
                    <input type="url" id="buttonModalUrl" class="button-modal-input" placeholder="https://example.com" required>
                    <p style="font-size: 12px; color: #64748b; margin-top: 6px;">
                        내부 링크는 /로 시작하는 경로를 입력하세요
                    </p>
                </div>

                <div class="button-modal-form-group">
                    <label class="button-modal-label">버튼 스타일</label>
                    <select id="buttonModalStyle" class="button-modal-select">
                        <option value="ql-button-primary">Primary (기본 - 브랜드 컬러)</option>
                        <option value="ql-button-secondary">Secondary (브랜드 컬러)</option>
                        <option value="ql-button-outline">Outline (테두리)</option>
                        <option value="ql-button-ghost">Ghost (투명 테두리)</option>
                    </select>
                </div>

                <div class="button-modal-form-group">
                    <label class="button-modal-checkbox">
                        <input type="checkbox" id="buttonModalNewTab">
                        <span style="font-size: 13px; color: #475569;">새 탭에서 열기</span>
                    </label>
                </div>

                <div class="button-modal-preview" id="buttonModalPreview">
                    <a href="#" class="ql-button ql-button-primary" id="buttonPreviewButton" style="color: white !important; text-decoration: none !important;">
                        <span class="ql-button-text">미리보기</span>
                        <span class="ql-button-icon"><svg aria-hidden="true" role="img" height="1em" width="1em" viewBox="0 0 256 512" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"></path></svg></span>
                    </a>
                </div>

                <div class="button-modal-footer">
                    <button type="button" class="wp-btn wp-btn-secondary" id="buttonModalCancel">
                        취소
                    </button>
                    <button type="button" class="wp-btn wp-btn-primary" id="buttonModalSave">
                        <span class="material-symbols-outlined" style="font-size: 18px;">check</span>
                        적용
                    </button>
                </div>
            </div>
        </div>

        <!-- 이미지 Alt 텍스트 모달 -->
        <div class="alt-modal" id="altModal">
            <div class="alt-modal-content">
                <div class="alt-modal-header">
                    <h3 class="alt-modal-title">이미지 정보 입력</h3>
                    <button type="button" class="alt-modal-close" id="altModalClose">
                        <span class="material-symbols-outlined" style="font-size: 24px;">close</span>
                    </button>
                </div>

                <img id="altModalImage" class="alt-modal-image" src="" alt="미리보기">

                <div class="alt-modal-form-group">
                    <label class="alt-modal-label">
                        Alt 텍스트 <span class="required">*</span>
                    </label>
                    <input type="text" id="altModalAltText" class="alt-modal-input" placeholder="이미지를 설명하는 텍스트를 입력하세요..." required>
                    <p style="font-size: 12px; color: #64748b; margin-top: 6px;">
                        시각 장애인과 검색 엔진을 위한 이미지 설명
                    </p>
                </div>

                <div class="alt-modal-form-group">
                    <label class="alt-modal-label">
                        Title (제목)
                    </label>
                    <input type="text" id="altModalTitle" class="alt-modal-input" placeholder="이미지 제목 (선택사항)">
                    <p style="font-size: 12px; color: #64748b; margin-top: 6px;">
                        마우스 오버 시 표시되는 텍스트
                    </p>
                </div>

                <div class="alt-modal-form-group">
                    <label class="alt-modal-label">
                        Caption (캡션)
                    </label>
                    <input type="text" id="altModalCaption" class="alt-modal-input" placeholder="이미지 캡션 (선택사항)">
                    <p style="font-size: 12px; color: #64748b; margin-top: 6px;">
                        이미지 하단에 표시될 설명
                    </p>
                </div>

                <div class="alt-modal-footer">
                    <button type="button" class="wp-btn wp-btn-secondary" id="altModalCancel">
                        취소
                    </button>
                    <button type="button" class="wp-btn wp-btn-primary" id="altModalSave">
                        <span class="material-symbols-outlined" style="font-size: 18px;">check</span>
                        저장
                    </button>
                </div>
            </div>
        </div>

        <!-- 이미지 크기 조정 모달 -->
        <div class="resize-modal" id="resizeModal">
            <div class="resize-modal-content">
                <div class="resize-modal-header">
                    <h3 class="resize-modal-title">이미지 크기 조정</h3>
                    <button type="button" class="resize-modal-close" id="resizeModalClose">
                        <span class="material-symbols-outlined" style="font-size: 24px;">close</span>
                    </button>
                </div>

                <div class="resize-preview" id="resizePreview">
                    <img id="resizePreviewImage" src="" alt="미리보기" style="max-width: 100%; height: auto;">
                </div>

                <div class="resize-presets">
                    <button type="button" class="resize-preset-btn" data-size="25">25%</button>
                    <button type="button" class="resize-preset-btn" data-size="50">50%</button>
                    <button type="button" class="resize-preset-btn" data-size="75">75%</button>
                    <button type="button" class="resize-preset-btn" data-size="100">100%</button>
                    <button type="button" class="resize-preset-btn active" data-size="original">원본</button>
                    <button type="button" class="resize-preset-btn" data-size="fit">적응형</button>
                </div>

                <div class="resize-input-group">
                    <div class="resize-input-wrapper">
                        <label class="resize-input-label">너비</label>
                        <input type="number" id="resizeWidth" class="resize-input" min="1" step="1">
                        <div class="resize-unit" id="resizeWidthUnit">px</div>
                    </div>
                    <div class="resize-input-wrapper">
                        <label class="resize-input-label">높이</label>
                        <input type="number" id="resizeHeight" class="resize-input" min="1" step="1">
                        <div class="resize-unit" id="resizeHeightUnit">px</div>
                    </div>
                </div>

                <div style="margin-bottom: 16px;">
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                        <input type="checkbox" id="resizeMaintainAspect" checked style="width: 18px; height: 18px; cursor: pointer;">
                        <span style="font-size: 13px; color: #475569; font-weight: 500;">비율 유지</span>
                    </label>
                </div>

                <div style="margin-bottom: 16px;">
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                        <input type="radio" name="resizeUnit" value="px" checked style="width: 18px; height: 18px; cursor: pointer;">
                        <span style="font-size: 13px; color: #475569; font-weight: 500;">픽셀 (px)</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin-top: 8px;">
                        <input type="radio" name="resizeUnit" value="%" style="width: 18px; height: 18px; cursor: pointer;">
                        <span style="font-size: 13px; color: #475569; font-weight: 500;">퍼센트 (%)</span>
                    </label>
                </div>

                <div class="alt-modal-footer">
                    <button type="button" class="wp-btn wp-btn-secondary" id="resizeModalCancel">
                        취소
                    </button>
                    <button type="button" class="wp-btn wp-btn-primary" id="resizeModalSave">
                        <span class="material-symbols-outlined" style="font-size: 18px;">check</span>
                        적용
                    </button>
                </div>
            </div>
        </div>
    </div>


    <!-- Editor.js -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/editorjs@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/paragraph@latest/dist/bundle.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/header@latest/dist/bundle.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/list@latest/dist/bundle.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/quote@latest/dist/bundle.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/code@latest/dist/bundle.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/delimiter@latest/dist/bundle.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/table@latest/dist/table.js"></script>

    <script>
        // 플러그인이 로드될 때까지 대기
        window.addEventListener('load', function() {
            setTimeout(function() {
                // EditorJS와 플러그인이 로드되었는지 확인
                if (typeof EditorJS === 'undefined') {
                    console.error('EditorJS가 로드되지 않았습니다.');
                    alert('에디터를 로드하는 중 오류가 발생했습니다. 페이지를 새로고침 해주세요.');
                    return;
                }

                console.log('EditorJS 로드됨');
                console.log('사용 가능한 플러그인:', {
                    Header: typeof Header !== 'undefined',
                    List: typeof List !== 'undefined',
                    Quote: typeof Quote !== 'undefined',
                    CodeTool: typeof CodeTool !== 'undefined',
                    Delimiter: typeof Delimiter !== 'undefined',
                    Table: typeof Table !== 'undefined'
                });

                initializeEditor();
            }, 2000);
        });

        // CSRF 토큰 가져오기 함수 (전역)
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        // 커스텀 이미지 도구
        class CustomImageTool {
            constructor({data, api}) {
                this.data = data || {};
                this.api = api;
                this.wrapper = null;
                this.settingsOpened = false;
            }

            static get toolbox() {
                return {
                    title: 'Image',
                    icon: '<svg width="17" height="15" viewBox="0 0 336 276" xmlns="http://www.w3.org/2000/svg"><path d="M291 150V79c0-19-15-34-34-34H79c-19 0-34 15-34 34v42l67-44 81 72 56-29 42 30zm0 52l-43-30-56 30-81-67-66 39v23c0 19 15 34 34 34h178c17 0 31-13 34-29zM79 0h178c44 0 79 35 79 79v118c0 44-35 79-79 79H79c-44 0-79-35-79-79V79C0 35 35 0 79 0z"/></svg>'
                };
            }

            render() {
                this.wrapper = document.createElement('div');
                this.wrapper.classList.add('custom-image-tool');

                if (this.data && this.data.url) {
                    this._renderImage();
                } else {
                    this._renderFileButton();
                }

                return this.wrapper;
            }

            _renderFileButton() {
                this.wrapper.innerHTML = `
                    <div style="padding: 40px; border: 2px dashed #e2e8f0; border-radius: 8px; text-align: center; cursor: pointer;" class="image-upload-area">
                        <svg width="48" height="48" viewBox="0 0 336 276" xmlns="http://www.w3.org/2000/svg" style="margin: 0 auto 16px; display: block; fill: #cbd5e0;"><path d="M291 150V79c0-19-15-34-34-34H79c-19 0-34 15-34 34v42l67-44 81 72 56-29 42 30zm0 52l-43-30-56 30-81-67-66 39v23c0 19 15 34 34 34h178c17 0 31-13 34-29zM79 0h178c44 0 79 35 79 79v118c0 44-35 79-79 79H79c-44 0-79-35-79-79V79C0 35 35 0 79 0z"/></svg>
                        <p style="margin: 0; color: #4a5568; font-size: 14px;">이미지를 선택하거나 드래그하세요</p>
                        <input type="file" accept="image/*" style="display: none;" class="image-file-input">
                    </div>
                `;

                const area = this.wrapper.querySelector('.image-upload-area');
                const input = this.wrapper.querySelector('.image-file-input');

                area.addEventListener('click', () => input.click());
                input.addEventListener('change', (e) => this._handleFile(e.target.files[0]));
            }

            async _handleFile(file) {
                if (!file) return;

                this.wrapper.innerHTML = '<div style="text-align: center; padding: 40px;">업로드 중...</div>';

                const formData = new FormData();
                formData.append('image', file);

                try {
                    const response = await fetch('{% url "community:badmintok_image_upload" %}', {
                        method: 'POST',
                        headers: {
                            'X-CSRFToken': getCookie('csrftoken')
                        },
                        body: formData
                    });

                    const result = await response.json();

                    if (result.success && result.url) {
                        this.data = {
                            url: result.url,
                            alt: '',
                            caption: '',
                            width: '100%'
                        };
                        this._renderImage();
                    } else {
                        throw new Error(result.error || '이미지 업로드 실패');
                    }
                } catch (error) {
                    console.error('이미지 업로드 오류:', error);
                    alert('이미지 업로드 중 오류가 발생했습니다.');
                    this._renderFileButton();
                }
            }

            _renderImage() {
                const { url, alt, caption, width } = this.data;

                this.wrapper.innerHTML = `
                    <div class="image-container">
                        <div style="max-width: ${width || '100%'}; margin: 0 auto;">
                            <img src="${url}" alt="${alt || ''}" style="width: 100%; border-radius: 8px; display: block;">
                            ${caption ? `<p style="margin: 8px 0 0 0; font-size: 14px; color: #718096; text-align: center;">${caption}</p>` : ''}
                        </div>
                        <button type="button" class="image-settings-button" style="margin-top: 12px; padding: 8px 16px; background: #f7fafc; border: 1px solid #e2e8f0; border-radius: 4px; cursor: pointer; font-size: 13px; width: 100%;">
                            설정
                        </button>
                        <div class="image-settings-panel" style="display: none; margin-top: 12px; padding: 16px; background: #f7fafc; border-radius: 8px; border: 1px solid #e2e8f0;">
                            <div style="margin-bottom: 12px;">
                                <label style="display: block; margin-bottom: 4px; font-size: 13px; color: #4a5568;">대체 텍스트 (Alt):</label>
                                <input type="text" class="image-alt-input" value="${alt || ''}" placeholder="이미지 설명" style="width: 100%; padding: 8px; border: 1px solid #cbd5e0; border-radius: 4px; font-size: 13px;">
                            </div>
                            <div style="margin-bottom: 12px;">
                                <label style="display: block; margin-bottom: 4px; font-size: 13px; color: #4a5568;">제목/캡션:</label>
                                <input type="text" class="image-caption-input" value="${caption || ''}" placeholder="이미지 제목" style="width: 100%; padding: 8px; border: 1px solid #cbd5e0; border-radius: 4px; font-size: 13px;">
                            </div>
                            <div style="margin-bottom: 12px;">
                                <label style="display: block; margin-bottom: 4px; font-size: 13px; color: #4a5568;">크기:</label>
                                <select class="image-width-select" style="width: 100%; padding: 8px; border: 1px solid #cbd5e0; border-radius: 4px; font-size: 13px;">
                                    <option value="100%" ${width === '100%' ? 'selected' : ''}>전체 너비 (100%)</option>
                                    <option value="75%" ${width === '75%' ? 'selected' : ''}>75%</option>
                                    <option value="50%" ${width === '50%' ? 'selected' : ''}>50%</option>
                                    <option value="600px" ${width === '600px' ? 'selected' : ''}>고정 크기 (600px)</option>
                                </select>
                            </div>
                            <button type="button" class="image-apply-button" style="padding: 8px 16px; background: #3b82f6; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 13px; width: 100%;">
                                적용
                            </button>
                        </div>
                    </div>
                `;

                const settingsButton = this.wrapper.querySelector('.image-settings-button');
                const settingsPanel = this.wrapper.querySelector('.image-settings-panel');
                const applyButton = this.wrapper.querySelector('.image-apply-button');

                settingsButton.addEventListener('click', (e) => {
                    e.preventDefault();
                    this.settingsOpened = !this.settingsOpened;
                    settingsPanel.style.display = this.settingsOpened ? 'block' : 'none';
                });

                applyButton.addEventListener('click', (e) => {
                    e.preventDefault();
                    this.data.alt = this.wrapper.querySelector('.image-alt-input').value;
                    this.data.caption = this.wrapper.querySelector('.image-caption-input').value;
                    this.data.width = this.wrapper.querySelector('.image-width-select').value;
                    this.settingsOpened = false;
                    this._renderImage();
                });
            }

            save() {
                return this.data;
            }
        }

        // 커스텀 YouTube 임베드 도구
        class YouTubeTool {
            constructor({data}) {
                this.data = data || {};
                this.wrapper = null;
            }

            static get toolbox() {
                return {
                    title: 'YouTube',
                    icon: '<svg width="17" height="15" viewBox="0 0 17 15" xmlns="http://www.w3.org/2000/svg"><path d="M16.6 3.7s-.2-1.1-.6-1.6c-.6-.6-1.3-.6-1.6-.7C11.8 1 8.5 1 8.5 1h0S5.2 1 2.6 1.4c-.3 0-1 0-1.6.7-.5.5-.6 1.6-.6 1.6S0 5 0 6.3v1.2C0 9 0 10.3.4 10.3s.2-1.1.6-1.6c.6-.6 1.3-.6 1.6-.7 2.6-.3 5.9-.4 5.9-.4s3.3 0 5.9.4c.3 0 1 0 1.6.7.5.5.6 1.6.6 1.6s.4 1.3.4 2.6v1.2c0 1.3-.4 2.6-.4 2.6s-.2 1.1-.6 1.6c-.6.6-1.3.6-1.6.7-2.6.3-5.9.4-5.9.4s-3.3 0-5.9-.4c-.3 0-1 0-1.6-.7-.5-.5-.6-1.6-.6-1.6S0 10 0 8.7V7.5c0-1.3.4-2.6.4-2.6z"/><path fill="#fff" d="M6.8 10.2l4.5-2.5-4.5-2.5z"/></svg>'
                };
            }

            render() {
                this.wrapper = document.createElement('div');
                this.wrapper.classList.add('youtube-tool');

                if (this.data && this.data.url) {
                    this.wrapper.innerHTML = this._createIframe(this.data.url, this.data.width || '100%');
                } else {
                    this._renderInput();
                }

                return this.wrapper;
            }

            _renderInput() {
                this.wrapper.innerHTML = `
                    <div style="padding: 20px; border: 2px dashed #e2e8f0; border-radius: 8px;">
                        <input
                            type="text"
                            class="youtube-url-input"
                            placeholder="YouTube URL을 입력하세요 (예: https://www.youtube.com/watch?v=...)"
                            style="width: 100%; padding: 12px; border: 1px solid #cbd5e0; border-radius: 4px; font-size: 14px; margin-bottom: 10px;"
                        />
                        <div style="margin-bottom: 10px;">
                            <label style="display: block; margin-bottom: 5px; font-size: 14px; color: #4a5568;">크기:</label>
                            <select class="youtube-width-select" style="padding: 8px; border: 1px solid #cbd5e0; border-radius: 4px; font-size: 14px;">
                                <option value="100%">전체 너비 (100%)</option>
                                <option value="75%">75%</option>
                                <option value="50%">50%</option>
                                <option value="600px">고정 크기 (600px)</option>
                            </select>
                        </div>
                        <button
                            type="button"
                            class="youtube-add-button"
                            style="padding: 10px 20px; background: #ef4444; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; width: 100%;"
                        >
                            추가
                        </button>
                    </div>
                `;

                // 버튼 이벤트 리스너 추가
                const button = this.wrapper.querySelector('.youtube-add-button');
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    this._handleAdd();
                });
            }

            _handleAdd() {
                const input = this.wrapper.querySelector('.youtube-url-input');
                const widthSelect = this.wrapper.querySelector('.youtube-width-select');
                const url = input.value.trim();
                const width = widthSelect.value;

                if (url && this._extractVideoId(url)) {
                    this.data = { url, width };
                    this.wrapper.innerHTML = this._createIframe(url, width);
                } else {
                    alert('유효한 YouTube URL을 입력해주세요.');
                }
            }

            _createIframe(url, width = '100%') {
                const videoId = this._extractVideoId(url);
                if (!videoId) {
                    return '<div style="padding: 20px; color: red;">유효하지 않은 YouTube URL입니다.</div>';
                }

                return `
                    <div style="max-width: ${width}; margin: 0 auto;">
                        <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 8px;">
                            <iframe
                                src="https://www.youtube.com/embed/${videoId}"
                                frameborder="0"
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                allowfullscreen
                                style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
                            ></iframe>
                        </div>
                    </div>
                `;
            }

            _extractVideoId(url) {
                const patterns = [
                    /(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/,
                    /^([a-zA-Z0-9_-]{11})$/
                ];

                for (let pattern of patterns) {
                    const match = url.match(pattern);
                    if (match && match[1]) {
                        return match[1];
                    }
                }
                return null;
            }

            save() {
                return this.data;
            }
        }

        // 커스텀 버튼 도구
        class ButtonTool {
            constructor({data}) {
                this.data = data || {
                    text: '',
                    url: '',
                    style: 'primary',
                    size: 'medium'
                };
                this.wrapper = null;
            }

            static get toolbox() {
                return {
                    title: '버튼',
                    icon: '<svg width="17" height="15" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="8" width="18" height="8" rx="2" stroke="currentColor" stroke-width="2"/></svg>'
                };
            }

            render() {
                this.wrapper = document.createElement('div');
                this.wrapper.classList.add('button-tool');

                if (this.data && this.data.text && this.data.url) {
                    this._renderPreview();
                } else {
                    this._renderInput();
                }

                return this.wrapper;
            }

            _renderInput() {
                this.wrapper.innerHTML = `
                    <div style="padding: 20px; border: 2px dashed #e2e8f0; border-radius: 8px; background: #f8fafc;">
                        <div style="margin-bottom: 12px;">
                            <label style="display: block; margin-bottom: 5px; font-size: 14px; color: #4a5568; font-weight: 500;">버튼 텍스트:</label>
                            <input
                                type="text"
                                class="button-text-input"
                                placeholder="버튼에 표시될 텍스트를 입력하세요"
                                value="${this.data.text || ''}"
                                style="width: 100%; padding: 12px; border: 1px solid #cbd5e0; border-radius: 4px; font-size: 14px;"
                            />
                        </div>

                        <div style="margin-bottom: 12px;">
                            <label style="display: block; margin-bottom: 5px; font-size: 14px; color: #4a5568; font-weight: 500;">링크 URL:</label>
                            <input
                                type="text"
                                class="button-url-input"
                                placeholder="https://example.com"
                                value="${this.data.url || ''}"
                                style="width: 100%; padding: 12px; border: 1px solid #cbd5e0; border-radius: 4px; font-size: 14px;"
                            />
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px; font-size: 14px; color: #4a5568; font-weight: 500;">스타일:</label>
                                <select class="button-style-select" style="width: 100%; padding: 10px; border: 1px solid #cbd5e0; border-radius: 4px; font-size: 14px;">
                                    <option value="primary" ${this.data.style === 'primary' ? 'selected' : ''}>Primary (브랜드 컬러)</option>
                                    <option value="secondary" ${this.data.style === 'secondary' ? 'selected' : ''}>Secondary (회색)</option>
                                    <option value="outline" ${this.data.style === 'outline' ? 'selected' : ''}>Outline (테두리)</option>
                                </select>
                            </div>

                            <div>
                                <label style="display: block; margin-bottom: 5px; font-size: 14px; color: #4a5568; font-weight: 500;">크기:</label>
                                <select class="button-size-select" style="width: 100%; padding: 10px; border: 1px solid #cbd5e0; border-radius: 4px; font-size: 14px;">
                                    <option value="small" ${this.data.size === 'small' ? 'selected' : ''}>작게</option>
                                    <option value="medium" ${this.data.size === 'medium' ? 'selected' : ''}>중간</option>
                                    <option value="large" ${this.data.size === 'large' ? 'selected' : ''}>크게</option>
                                </select>
                            </div>
                        </div>

                        <button
                            type="button"
                            class="button-save-btn"
                            style="padding: 12px 24px; background: #3b82f6; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; width: 100%; font-weight: 500;"
                        >
                            ${this.data.text ? '업데이트' : '버튼 추가'}
                        </button>
                    </div>
                `;

                const saveBtn = this.wrapper.querySelector('.button-save-btn');
                saveBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    this._handleSave();
                });
            }

            _handleSave() {
                const textInput = this.wrapper.querySelector('.button-text-input');
                const urlInput = this.wrapper.querySelector('.button-url-input');
                const styleSelect = this.wrapper.querySelector('.button-style-select');
                const sizeSelect = this.wrapper.querySelector('.button-size-select');

                const text = textInput.value.trim();
                const url = urlInput.value.trim();
                const style = styleSelect.value;
                const size = sizeSelect.value;

                if (!text) {
                    alert('버튼 텍스트를 입력해주세요.');
                    return;
                }

                if (!url) {
                    alert('링크 URL을 입력해주세요.');
                    return;
                }

                this.data = { text, url, style, size };
                this._renderPreview();
            }

            _renderPreview() {
                const { text, url, style, size } = this.data;

                // 스타일별 CSS
                let buttonStyles = '';
                if (style === 'primary') {
                    buttonStyles = 'background: #31AA60; color: white; border: none;';
                } else if (style === 'secondary') {
                    buttonStyles = 'background: #64748b; color: white; border: none;';
                } else if (style === 'outline') {
                    buttonStyles = 'background: transparent; color: #31AA60; border: 2px solid #31AA60;';
                }

                // 크기별 폰트 (패딩은 고정 10px)
                let sizeStyles = 'padding: 10px;';
                if (size === 'small') {
                    sizeStyles += ' font-size: 14px;';
                } else if (size === 'medium') {
                    sizeStyles += ' font-size: 16px;';
                } else if (size === 'large') {
                    sizeStyles += ' font-size: 18px;';
                }

                this.wrapper.innerHTML = `
                    <div style="padding: 20px; border: 2px solid #e2e8f0; border-radius: 8px; background: #f8fafc; position: relative;">
                        <div style="text-align: center; margin-bottom: 12px;">
                            <a href="${url}" target="_blank" style="display: inline-block; width: 70%; ${buttonStyles} ${sizeStyles} border-radius: 8px; text-decoration: none; font-weight: 500; transition: all 0.2s; text-align: center;">
                                ${text}
                            </a>
                        </div>
                        <button
                            type="button"
                            class="button-edit-btn"
                            style="padding: 6px 12px; background: #f1f5f9; color: #475569; border: 1px solid #cbd5e0; border-radius: 4px; cursor: pointer; font-size: 12px; width: 100%;"
                        >
                            편집
                        </button>
                    </div>
                `;

                const editBtn = this.wrapper.querySelector('.button-edit-btn');
                editBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    this._renderInput();
                });
            }

            save() {
                return this.data;
            }
        }

        function initializeEditor() {
        // CSRF 토큰 가져오기
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

        // HTML을 Editor.js JSON으로 변환 (기존 Quill HTML 포스트용)
        // 임베드 서비스 감지 함수
        function detectEmbedService(url) {
            if (url.includes('youtube.com') || url.includes('youtu.be')) {
                return 'youtube';
            } else if (url.includes('vimeo.com')) {
                return 'vimeo';
            } else if (url.includes('coub.com')) {
                return 'coub';
            } else if (url.includes('codepen.io')) {
                return 'codepen';
            } else if (url.includes('instagram.com')) {
                return 'instagram';
            } else if (url.includes('twitter.com') || url.includes('x.com')) {
                return 'twitter';
            } else if (url.includes('facebook.com')) {
                return 'facebook';
            }
            return 'youtube'; // 기본값
        }

        function convertHTMLToEditorJS(html) {
            if (!html || !html.trim()) {
                return { blocks: [] };
            }

            const parser = new DOMParser();
            const doc = parser.parseFromString(html, 'text/html');
            const blocks = [];

            function processNode(node) {
                if (node.nodeType === Node.TEXT_NODE) {
                    const text = node.textContent.trim();
                    if (text) {
                        blocks.push({
                            type: 'paragraph',
                            data: { text: text }
                        });
                    }
                } else if (node.nodeType === Node.ELEMENT_NODE) {
                    const tagName = node.tagName.toLowerCase();

                    if (tagName === 'h1' || tagName === 'h2' || tagName === 'h3') {
                        blocks.push({
                            type: 'header',
                            data: {
                                text: node.textContent.trim(),
                                level: parseInt(tagName[1])
                            }
                        });
                    } else if (tagName === 'p') {
                        const text = node.innerHTML.trim();
                        if (text) {
                            blocks.push({
                                type: 'paragraph',
                                data: { text: text }
                            });
                        }
                    } else if (tagName === 'blockquote') {
                        blocks.push({
                            type: 'quote',
                            data: {
                                text: node.textContent.trim(),
                                caption: ''
                            }
                        });
                    } else if (tagName === 'ul' || tagName === 'ol') {
                        const items = Array.from(node.querySelectorAll('li')).map(li => li.textContent.trim());
                        if (items.length > 0) {
                            blocks.push({
                                type: 'list',
                                data: {
                                    style: tagName === 'ul' ? 'unordered' : 'ordered',
                                    items: items
                                }
                            });
                        }
                    } else if (tagName === 'img') {
                        blocks.push({
                            type: 'image',
                            data: {
                                file: { url: node.src },
                                caption: node.alt || '',
                                withBorder: false,
                                stretched: false,
                                withBackground: false
                            }
                        });
                    } else if (tagName === 'pre') {
                        blocks.push({
                            type: 'code',
                            data: { code: node.textContent }
                        });
                    } else if (tagName === 'iframe') {
                        // YouTube, Vimeo 등 임베드 처리
                        const src = node.src;
                        if (src) {
                            blocks.push({
                                type: 'embed',
                                data: {
                                    service: detectEmbedService(src),
                                    source: src,
                                    embed: src,
                                    width: node.width || 600,
                                    height: node.height || 300,
                                    caption: ''
                                }
                            });
                        }
                    } else {
                        // 자식 노드 처리
                        for (let child of node.childNodes) {
                            processNode(child);
                        }
                    }
                }
            }

            for (let child of doc.body.childNodes) {
                processNode(child);
            }

            return { blocks: blocks };
        }

        // Editor.js 초기화
        let editor = null;
        const hiddenContent = document.getElementById('hidden_content');

        // 초기 데이터 파싱
        let initialData = null;
        if (hiddenContent && hiddenContent.value && hiddenContent.value.trim()) {
            try {
                const parsed = JSON.parse(hiddenContent.value);
                if (parsed.blocks && Array.isArray(parsed.blocks)) {
                    // 이미 Editor.js JSON 형식
                    initialData = parsed;
                } else {
                    throw new Error('Not Editor.js format');
                }
            } catch (e) {
                // JSON이 아니거나 Editor.js 형식이 아니면 HTML로 간주하고 변환
                console.log('Converting HTML to Editor.js format...');
                initialData = convertHTMLToEditorJS(hiddenContent.value);
            }
        }

        // 커스텀 헤더 도구 클래스 생성
        class H1Tool extends Header {
            static get toolbox() {
                return {
                    title: 'H1',
                    icon: '<svg width="12" height="14" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 14"><path d="M2.77 14V8.67h5.54V14h2.94V1.25h-2.94v4.83H2.77V1.25H0V14z"/></svg>'
                };
            }

            constructor({data, config, api, readOnly}) {
                super({
                    data: data,
                    config: {...config, levels: [1], defaultLevel: 1},
                    api: api,
                    readOnly: readOnly
                });
            }
        }

        class H2Tool extends Header {
            static get toolbox() {
                return {
                    title: 'H2',
                    icon: '<svg width="14" height="14" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14"><path d="M2.77 14V8.67h5.54V14h2.94V1.25h-2.94v4.83H2.77V1.25H0V14z"/></svg>'
                };
            }

            constructor({data, config, api, readOnly}) {
                super({
                    data: data,
                    config: {...config, levels: [2], defaultLevel: 2},
                    api: api,
                    readOnly: readOnly
                });
            }
        }

        class H3Tool extends Header {
            static get toolbox() {
                return {
                    title: 'H3',
                    icon: '<svg width="16" height="14" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 14"><path d="M2.77 14V8.67h5.54V14h2.94V1.25h-2.94v4.83H2.77V1.25H0V14z"/></svg>'
                };
            }

            constructor({data, config, api, readOnly}) {
                super({
                    data: data,
                    config: {...config, levels: [3], defaultLevel: 3},
                    api: api,
                    readOnly: readOnly
                });
            }
        }

        // tools 객체 생성
        const editorTools = {
                h1: {
                    class: H1Tool,
                    inlineToolbar: true,
                    config: {
                        placeholder: '제목 1을 입력하세요'
                    }
                },
                h2: {
                    class: H2Tool,
                    inlineToolbar: true,
                    config: {
                        placeholder: '제목 2를 입력하세요'
                    }
                },
                h3: {
                    class: H3Tool,
                    inlineToolbar: true,
                    config: {
                        placeholder: '제목 3을 입력하세요'
                    }
                },
                list: {
                    class: List,
                    inlineToolbar: true,
                    config: {
                        defaultStyle: 'unordered'
                    }
                },
                quote: {
                    class: Quote,
                    inlineToolbar: true,
                    config: {
                        quotePlaceholder: '인용구를 입력하세요',
                        captionPlaceholder: '출처'
                    }
                },
                code: {
                    class: CodeTool,
                    config: {
                        placeholder: '코드를 입력하세요'
                    }
                },
                delimiter: Delimiter,
                table: {
                    class: Table,
                    inlineToolbar: true,
                    config: {
                        rows: 2,
                        cols: 3
                    }
                }
        };

        // 커스텀 이미지 도구 추가
        editorTools.image = CustomImageTool;
        console.log('✅ 커스텀 이미지 도구가 추가되었습니다');

        // 커스텀 YouTube 도구 추가
        editorTools.youtube = YouTubeTool;
        console.log('✅ 커스텀 YouTube 도구가 추가되었습니다');

        // 커스텀 버튼 도구 추가
        editorTools.button = ButtonTool;
        console.log('✅ 커스텀 버튼 도구가 추가되었습니다');

        console.log('전달할 tools 객체:', Object.keys(editorTools));

        // Editor.js 초기화
        editor = new EditorJS({
            holder: 'editorjs-content',
            placeholder: '이야기를 시작하세요...',
            tools: editorTools,
            data: initialData || undefined,
            minHeight: 500
        });

        // Editor.js에서 텍스트 추출 (SEO 분석용)
        async function getEditorText() {
            try {
                const outputData = await editor.save();
                let text = '';

                outputData.blocks.forEach(block => {
                    if (block.type === 'paragraph' || block.type === 'header') {
                        // HTML 태그 제거
                        const div = document.createElement('div');
                        div.innerHTML = block.data.text || '';
                        text += div.textContent + ' ';
                    } else if (block.type === 'list') {
                        text += (block.data.items || []).join(' ') + ' ';
                    } else if (block.type === 'quote') {
                        text += (block.data.text || '') + ' ';
                    } else if (block.type === 'code') {
                        text += (block.data.code || '') + ' ';
                    } else if (block.type === 'table' && block.data.content) {
                        block.data.content.forEach(row => {
                            text += row.join(' ') + ' ';
                        });
                    }
                });

                return text.trim();
            } catch (error) {
                console.error('Error extracting text:', error);
                return '';
            }
        }

        // 제목 입력 auto-resize
        const titleInput = document.getElementById('wpTitleInput');
        if (titleInput) {
            titleInput.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = this.scrollHeight + 'px';
            });

            // 초기 높이 설정
            titleInput.style.height = 'auto';
            titleInput.style.height = titleInput.scrollHeight + 'px';
        }

        // 저장 상태 업데이트
        const saveStatus = document.querySelector('.wp-save-status');
        function updateSaveStatus(type, message) {
            if (saveStatus) {
                saveStatus.className = 'wp-save-status ' + type;
                saveStatus.textContent = message;
            }
        }

        // 자동 저장
        let autoSaveTimeout;
        function autoSave() {
            if (!titleInput || !editor) return;

            clearTimeout(autoSaveTimeout);
            updateSaveStatus('saving', '저장 중...');

            autoSaveTimeout = setTimeout(async () => {
                try {
                    const title = titleInput.value;
                    const content = await editor.save();

                    // localStorage에 임시 저장
                    const draftKey = 'badmintok_post_draft{% if post %}_{{ post.id }}{% endif %}';
                    const draftData = {
                        title: title,
                        content: JSON.stringify(content),
                        timestamp: Date.now()
                    };

                    localStorage.setItem(draftKey, JSON.stringify(draftData));
                    updateSaveStatus('saved', '저장됨');
                } catch (error) {
                    console.error('자동 저장 오류:', error);
                    updateSaveStatus('saved', '저장 실패');
                }
            }, 1000);
        }

        // 에디터 준비 후 자동 저장 설정
        editor.isReady.then(() => {
            console.log('Editor.js 초기화 완료');

            // 변경 감지는 간단하게 처리 (Editor.js는 onChange 콜백 없음)
            setInterval(autoSave, 30000); // 30초마다 자동 저장
        });

        // 제목 변경 시 자동 저장
        if (titleInput) {
            titleInput.addEventListener('input', autoSave);
        }

        // 임시 저장본 복원
        window.addEventListener('load', function() {
            const draftKey = 'badmintok_post_draft{% if post %}_{{ post.id }}{% endif %}';
            const savedDraft = localStorage.getItem(draftKey);

            if (savedDraft && !{% if post %}true{% else %}false{% endif %}) {
                try {
                    const draftData = JSON.parse(savedDraft);
                    const savedTime = new Date(draftData.timestamp);
                    const now = new Date();
                    const timeDiff = (now - savedTime) / 1000 / 60; // 분 단위

                    if (timeDiff < 30) {
                        if (confirm(`${Math.round(timeDiff)}분 전에 저장된 임시 저장본이 있습니다. 복원하시겠습니까?`)) {
                            titleInput.value = draftData.title || '';

                            // Editor.js 데이터 복원
                            const content = JSON.parse(draftData.content);
                            editor.isReady.then(() => {
                                editor.render(content);
                            });

                            titleInput.style.height = 'auto';
                            titleInput.style.height = titleInput.scrollHeight + 'px';
                        }
                    }
                } catch (e) {
                    console.error('임시 저장본 복원 오류:', e);
                }
            }
        });

        // 폼 제출 처리
        const postForm = document.getElementById('postForm');
        if (postForm && editor && hiddenContent) {
            postForm.addEventListener('submit', async function(e) {
                e.preventDefault();

                try {
                    // 에디터 내용 가져오기
                    const outputData = await editor.save();

                    // 빈 내용 체크
                    if (!outputData.blocks || outputData.blocks.length === 0) {
                        alert('내용을 입력해주세요.');
                        return false;
                    }

                    // JSON을 hidden field에 저장
                    hiddenContent.value = JSON.stringify(outputData);

                    // 임시 저장본 삭제
                    const draftKey = 'badmintok_post_draft{% if post %}_{{ post.id }}{% endif %}';
                    localStorage.removeItem(draftKey);

                    // 폼 제출
                    this.submit();
                } catch (error) {
                    console.error('폼 제출 오류:', error);
                    alert('저장 중 오류가 발생했습니다.');
                    return false;
                }
            });
        }

        // 게시하기/임시저장 버튼
        const publishBtn = document.getElementById('publishBtn');
        const saveDraftBtn = document.getElementById('saveDraftBtn');

        if (publishBtn) {
            publishBtn.addEventListener('click', function() {
                if (postForm) {
                    postForm.submit();
                }
            });
        }

        if (saveDraftBtn) {
            saveDraftBtn.addEventListener('click', async function() {
                try {
                    const outputData = await editor.save();
                    hiddenContent.value = JSON.stringify(outputData);

                    // 임시저장 input 추가
                    const draftInput = document.createElement('input');
                    draftInput.type = 'hidden';
                    draftInput.name = 'save_draft';
                    draftInput.value = 'true';
                    postForm.appendChild(draftInput);

                    postForm.submit();
                } catch (error) {
                    console.error('임시저장 오류:', error);
                    alert('임시저장 중 오류가 발생했습니다.');
                }
            });
        }

        // 미리보기
        const previewBtn = document.getElementById('previewBtn');
        if (previewBtn && titleInput && editor) {
            previewBtn.addEventListener('click', async function() {
                try {
                    const title = titleInput.value || '제목 없음';
                    const outputData = await editor.save();

                    // Editor.js 블록을 HTML로 변환
                    let htmlContent = '';
                    outputData.blocks.forEach(block => {
                        if (block.type === 'header') {
                            htmlContent += `<h${block.data.level}>${block.data.text}</h${block.data.level}>`;
                        } else if (block.type === 'paragraph') {
                            htmlContent += `<p>${block.data.text}</p>`;
                        } else if (block.type === 'list') {
                            const tag = block.data.style === 'ordered' ? 'ol' : 'ul';
                            htmlContent += `<${tag}>`;
                            (block.data.items || []).forEach(item => {
                                htmlContent += `<li>${item}</li>`;
                            });
                            htmlContent += `</${tag}>`;
                        } else if (block.type === 'quote') {
                            htmlContent += `<blockquote>${block.data.text}${block.data.caption ? `<footer>${block.data.caption}</footer>` : ''}</blockquote>`;
                        } else if (block.type === 'code') {
                            htmlContent += `<pre><code>${block.data.code}</code></pre>`;
                        } else if (block.type === 'image') {
                            htmlContent += `<figure><img src="${block.data.file.url}" alt="${block.data.caption || ''}"><figcaption>${block.data.caption || ''}</figcaption></figure>`;
                        } else if (block.type === 'delimiter') {
                            htmlContent += '<hr>';
                        } else if (block.type === 'table' && block.data.content) {
                            htmlContent += '<table border="1">';
                            block.data.content.forEach(row => {
                                htmlContent += '<tr>';
                                row.forEach(cell => {
                                    htmlContent += `<td>${cell}</td>`;
                                });
                                htmlContent += '</tr>';
                            });
                            htmlContent += '</table>';
                        }
                    });

                    // 새 창으로 미리보기
                    const previewWindow = window.open('', 'preview', 'width=800,height=600');
                    previewWindow.document.write(`
                        <!DOCTYPE html>
                        <html lang="ko">
                        <head>
                            <meta charset="UTF-8">
                            <meta name="viewport" content="width=device-width, initial-scale=1.0">
                            <title>미리보기 - ${title}</title>
                            <style>
                                body { max-width: 800px; margin: 0 auto; padding: 40px 20px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; line-height: 1.6; }
                                h1, h2, h3 { margin: 24px 0 12px; color: #1e293b; }
                                p { margin: 16px 0; color: #334155; }
                                img { max-width: 100%; height: auto; }
                                pre { background: #f8fafc; padding: 16px; border-radius: 8px; overflow-x: auto; }
                                blockquote { border-left: 4px solid #3b82f6; padding-left: 16px; margin: 16px 0; color: #64748b; }
                                table { border-collapse: collapse; width: 100%; margin: 16px 0; }
                                td { padding: 8px; border: 1px solid #e2e8f0; }
                                ul { margin: 16px 0; }
                                li { margin: 8px 0; }
                                mark { background: #fef08a; padding: 2px 4px; }
                                code { background: #f1f5f9; padding: 2px 6px; border-radius: 4px; font-family: monospace; }
                                u { text-decoration: underline; }
                            </style>
                        </head>
                        <body>
                            <h1>${title}</h1>
                            <hr>
                            ${htmlContent}
                        </body>
                        </html>
                    `);
                    previewWindow.document.close();
                } catch (error) {
                    console.error('미리보기 오류:', error);
                    alert('미리보기를 생성할 수 없습니다.');
                }
            });
        }

        // SEO 분석
        const focusKeywordInput = document.getElementById('focus_keyword');
        const metaDescInput = document.getElementById('meta_description');
        const slugInput = document.getElementById('slug');
        const seoScore = document.getElementById('seo-score');
        const seoCheckList = document.getElementById('seo-check-list');

        async function performSEOAnalysis() {
            if (!titleInput || !editor || !focusKeywordInput || !metaDescInput || !slugInput) {
                return;
            }

            const title = titleInput.value.trim();
            const content = await getEditorText();
            const focusKeyword = focusKeywordInput.value.trim().toLowerCase();
            const metaDescription = metaDescInput.value.trim();
            const slug = slugInput.value.trim();

            let score = 0;
            let maxScore = 10;
            let checks = [];

            // 1. 포커스 키워드가 제목에 있는지
            if (focusKeyword && title.toLowerCase().includes(focusKeyword)) {
                score += 2;
                checks.push({ status: 'good', text: '포커스 키워드가 제목에 포함되어 있습니다.' });
            } else if (focusKeyword) {
                checks.push({ status: 'bad', text: '포커스 키워드가 제목에 없습니다.' });
            }

            // 2. 포커스 키워드가 본문에 있는지
            if (focusKeyword && content.toLowerCase().includes(focusKeyword)) {
                score += 2;
                checks.push({ status: 'good', text: '포커스 키워드가 본문에 포함되어 있습니다.' });
            } else if (focusKeyword) {
                checks.push({ status: 'bad', text: '포커스 키워드가 본문에 없습니다.' });
            }

            // 3. 메타 설명 길이 체크
            if (metaDescription.length >= 120 && metaDescription.length <= 160) {
                score += 2;
                checks.push({ status: 'good', text: `메타 설명 길이가 적절합니다. (${metaDescription.length}자)` });
            } else if (metaDescription.length > 0) {
                checks.push({ status: 'warning', text: `메타 설명 길이를 120-160자로 조정하세요. (현재 ${metaDescription.length}자)` });
                score += 1;
            } else {
                checks.push({ status: 'bad', text: '메타 설명을 입력하세요.' });
            }

            // 4. 제목 길이 체크
            if (title.length >= 30 && title.length <= 60) {
                score += 1;
                checks.push({ status: 'good', text: `제목 길이가 적절합니다. (${title.length}자)` });
            } else if (title.length > 0) {
                checks.push({ status: 'warning', text: `제목 길이를 30-60자로 조정하세요. (현재 ${title.length}자)` });
            }

            // 5. 본문 길이 체크
            if (content.length >= 300) {
                score += 1;
                checks.push({ status: 'good', text: `본문이 충분합니다. (${content.length}자)` });
            } else {
                checks.push({ status: 'warning', text: `본문을 300자 이상 작성하세요. (현재 ${content.length}자)` });
            }

            // 6. Slug 체크
            if (slug.length > 0 && /^[a-z0-9-]+$/.test(slug)) {
                score += 1;
                checks.push({ status: 'good', text: 'URL 슬러그가 적절합니다.' });
            } else if (slug.length > 0) {
                checks.push({ status: 'warning', text: 'URL 슬러그는 영문 소문자, 숫자, 하이픈만 사용하세요.' });
            }

            // 7. 키워드 밀도 체크
            if (focusKeyword && content) {
                const keywordCount = (content.toLowerCase().match(new RegExp(focusKeyword, 'g')) || []).length;
                const wordCount = content.split(/\s+/).length;
                const density = wordCount > 0 ? (keywordCount / wordCount * 100) : 0;

                if (density >= 0.5 && density <= 2.5) {
                    score += 1;
                    checks.push({ status: 'good', text: `키워드 밀도가 적절합니다. (${density.toFixed(1)}%)` });
                } else if (density > 0) {
                    checks.push({ status: 'warning', text: `키워드 밀도를 0.5-2.5%로 조정하세요. (현재 ${density.toFixed(1)}%)` });
                }
            }

            // SEO 점수 표시
            const percentage = Math.round((score / maxScore) * 100);
            if (seoScore) {
                seoScore.textContent = percentage;
                const scoreElement = seoScore.parentElement;
                if (percentage >= 80) {
                    scoreElement.style.background = 'linear-gradient(135deg, #10b981, #059669)';
                } else if (percentage >= 50) {
                    scoreElement.style.background = 'linear-gradient(135deg, #f59e0b, #d97706)';
                } else {
                    scoreElement.style.background = 'linear-gradient(135deg, #ef4444, #dc2626)';
                }
            }

            // SEO 체크리스트 표시
            if (seoCheckList) {
                seoCheckList.innerHTML = checks.map(check => {
                    let emoji = check.status === 'good' ? '✅' : check.status === 'warning' ? '⚠️' : '❌';
                    let color = check.status === 'good' ? '#10b981' : check.status === 'warning' ? '#f59e0b' : '#ef4444';
                    return `<li style="color: ${color}; margin-bottom: 8px;">${emoji} ${check.text}</li>`;
                }).join('');
            }
        }

        // SEO 분석 트리거
        if (titleInput) {
            titleInput.addEventListener('input', performSEOAnalysis);
        }
        if (focusKeywordInput) {
            focusKeywordInput.addEventListener('input', performSEOAnalysis);
        }
        if (metaDescInput) {
            metaDescInput.addEventListener('input', performSEOAnalysis);
        }
        if (slugInput) {
            slugInput.addEventListener('input', performSEOAnalysis);
        }

        // 에디터 준비 후 SEO 분석
        editor.isReady.then(() => {
            performSEOAnalysis();

            // 에디터 변경 시 SEO 분석 (30초 간격)
            setInterval(performSEOAnalysis, 30000);
        });

        // 전체 화면 토글
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        const editorWrapper = document.querySelector('.wp-editor-wrapper');
        if (fullscreenBtn && editorWrapper) {
            fullscreenBtn.addEventListener('click', function() {
                editorWrapper.classList.toggle('fullscreen-mode');
                const icon = this.querySelector('.material-symbols-outlined');
                if (editorWrapper.classList.contains('fullscreen-mode')) {
                    icon.textContent = 'fullscreen_exit';
                } else {
                    icon.textContent = 'fullscreen';
                }
            });
        }

        // 썸네일 업로드
        const uploadThumbnailBtn = document.getElementById('uploadThumbnailBtn');
        const thumbnailInput = document.getElementById('id_thumbnail');
        const thumbnailPreview = document.getElementById('thumbnail-preview');

        if (uploadThumbnailBtn && thumbnailInput) {
            uploadThumbnailBtn.addEventListener('click', function() {
                thumbnailInput.click();
            });

            thumbnailInput.addEventListener('change', function() {
                const file = this.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        if (thumbnailPreview) {
                            thumbnailPreview.innerHTML = `<img src="${e.target.result}" alt="썸네일" style="width: 100%; height: auto; display: block;">`;
                        }
                    };
                    reader.readAsDataURL(file);
                }
            });
        }
        } // end initializeEditor
    </script>
</body>
</html>
