<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>카카오 로그인 중...</title>
</head>
<body>
    <script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.2/kakao.min.js"
            integrity="sha384-TiCUE00h649CAMonG018J2ujOgDKW/kVWlChEuu4jK2vxfAAD0eZxzCKakxg55G4"
            crossorigin="anonymous"></script>
    <script>
        // 카카오 SDK 초기화 (JavaScript 키 사용)
        if (window.Kakao && !Kakao.isInitialized()) {
            Kakao.init('{{ javascript_key }}');
        }

        // state를 localStorage에 저장 (콜백에서 검증용)
        // redirectUri에는 state를 포함시키지 않음 (카카오 콘솔 등록 URI와 정확히 일치해야 함)
        localStorage.setItem('kakao_oauth_state', '{{ state }}');

        // SDK를 사용하여 카카오 로그인 시작 (모바일 앱 자동 전환 지원)
        Kakao.Auth.authorize({
            redirectUri: '{{ redirect_uri }}',
            prompt: 'login'
        });
    </script>
</body>
</html>
